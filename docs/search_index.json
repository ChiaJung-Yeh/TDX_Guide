[["公車運輸資料.html", "Chapter 3 公車運輸資料 3.1 公車路線站點資料 3.2 公車路線線型資料 3.3 公車班表資料", " Chapter 3 公車運輸資料 公車係包含公路客運（一般公路客運、國道公路客運）與市區客運。後續的函式中皆須設定縣市之參數（county=），請參照TDX_County表格，縣市名稱與其相對應之代碼臚列如下。另請注意，若欲回傳公路客運之資料，county=之參數請設定為「Intercity」。 TDX_County 縣市名稱 縣市代碼 臺北市 Taipei 新北市 NewTaipei 桃園市 Taoyuan 臺中市 Taichung 臺南市 Tainan 高雄市 Kaohsiung 基隆市 Keelung 新竹市 Hsinchu 新竹縣 HsinchuCounty 苗栗縣 MiaoliCounty 彰化縣 ChanghuaCounty 南投縣 NantouCounty 雲林縣 YunlinCounty 嘉義縣 ChiayiCounty 嘉義市 Chiayi 屏東縣 PingtungCounty 宜蘭縣 YilanCounty 花蓮縣 HualienCounty 臺東縣 TaitungCounty 金門縣 KinmenCounty 澎湖縣 PenghuCounty 連江縣 LienchiangCounty 公路客運 Intercity 本資料之下載皆須利用 API 金鑰，故函式中須輸入app_id=與app_key=兩參數，亦即在 1.6.2 API 金鑰申請的 APP ID 與 APP Key。 公車運輸資料中提供路線站點、路線線型、班表等資料。 3.1 公車路線站點資料  資料概述 回傳結果為公車路線站點的屬性資料，欄位包括（子）路線名稱、（子）路線代碼、方向、站點名稱、站點代碼、站序、經緯度等資料。關於路線（RouteUID、SubRouteUID）、站點（StopUID、StationID）之定義請詳見公共運輸車站站點編碼作業規範與公車API靜態資料使用注意事項。  函式參數 Bus_StopOfRoute(app_id, app_key, county, dtype=&quot;text&quot;, out=FALSE) 參數 必選填 功能 參數設定值 app_id= 必填參數 [金鑰 APP ID] 1.6.2 API 金鑰申請的 APP ID app_key= [金鑰 APP Key] 1.6.2 API 金鑰申請的 APP Key county= 縣市代碼 請參照TDX_County表格，若為公路客運，請填入Intercity dtype= 選填參數 回傳的資料型態 text：純文字形式，其資料型態屬data.frame [預設值] sf：地理資料形式，其資料型態屬sf out= 匯出資料之路徑 FALSE：不匯出資料至本機 [預設值] 若回傳的資料型態為「text」：路徑必須含有.csv或.txt 若回傳的資料型態為「sf」：路徑必須含有.shp  程式碼撰寫範例 1. 回傳宜蘭縣市區公車路線站點資料（純文字） # 介接宜蘭公車路線站點 Yilan_bus_station=Bus_StopOfRoute(app_id, app_key, &quot;YilanCounty&quot;) ## [1] &quot;Success: (200) OK&quot; ## [1] &quot;182 Routes&quot; ## [1] &quot;10/182&quot; ## [1] &quot;20/182&quot; ## [1] &quot;30/182&quot; ## [1] &quot;40/182&quot; ## [1] &quot;50/182&quot; ## [1] &quot;60/182&quot; ## [1] &quot;70/182&quot; ## [1] &quot;80/182&quot; ## [1] &quot;90/182&quot; ## [1] &quot;100/182&quot; ## [1] &quot;110/182&quot; ## [1] &quot;120/182&quot; ## [1] &quot;130/182&quot; ## [1] &quot;140/182&quot; ## [1] &quot;150/182&quot; ## [1] &quot;160/182&quot; ## [1] &quot;170/182&quot; ## [1] &quot;180/182&quot; ## [1] &quot;182/182&quot; ## [1] &quot;#---YilanCounty Stop of Route Downloaded---#&quot; # 查看Yilan_bus_station資料 Yilan_bus_station 2. 回傳新竹市市區公車路線站點資料（地理資料） # 介接新竹市公車路線站點資料，並匯出地理資料 Hsinchu_bus_station=Bus_StopOfRoute(app_id, app_key, &quot;Hsinchu&quot;, dtype=&quot;sf&quot;, out=&quot;./Hsinchu_bus_station.shp&quot;) ## [1] &quot;Success: (200) OK&quot; ## [1] &quot;54 Routes&quot; ## [1] &quot;10/54&quot; ## [1] &quot;20/54&quot; ## [1] &quot;30/54&quot; ## [1] &quot;40/54&quot; ## [1] &quot;50/54&quot; ## [1] &quot;54/54&quot; ## [1] &quot;#---Hsinchu Stop of Route Downloaded---#&quot; # 查看Hsinchu_bus_station資料 Hsinchu_bus_station # Hsinchu_bus_station依路線合併所有點資料 Hsinchu_bus_station_agg=group_by(Hsinchu_bus_station, RouteName)%&gt;% summarise() # 地圖繪製 ggplot()+ geom_sf(data=Hsinchu_bus_station_agg, aes(color=RouteName))+ geom_sf_text_repel(data=Hsinchu_bus_station_agg, aes(label=RouteName, color=RouteName)) NOTE 以上程式碼中先行利用 group_by() %&gt;% summarise() 合併地理資料，可參考 Spatial Analysis with R (Chia Jung, Yeh) 5.2 章節 Attribute Aggregation R 語言中「地圖上文字標記」之方法，請參考 Spatial Analysis with R (Chia Jung, Yeh) 3.3 章節 Labels on Map 3.2 公車路線線型資料  資料概述 回傳結果為公車路線的屬性與空間資料，欄位包括（子）路線名稱、（子）路線代碼、方向、空間資料。  函式參數 Bus_Shape(app_id, app_key, county, dtype=&quot;text&quot;, out=FALSE) 參數 必選填 功能 參數設定值 app_id= 必填參數 [金鑰 APP ID] 1.6.2 API 金鑰申請的 APP ID app_key= [金鑰 APP Key] 1.6.2 API 金鑰申請的 APP Key county= 縣市代碼 請參照TDX_County表格，若為公路客運，請填入Intercity dtype= 選填參數 回傳的資料型態 text：純文字形式，其資料型態屬data.frame [預設值] sf：地理資料形式，其資料型態屬sf out= 匯出資料之路徑 FALSE：不匯出資料至本機 [預設值] 若回傳的資料型態為「text」：路徑必須含有.csv或.txt 若回傳的資料型態為「sf」：路徑必須含有.shp  程式碼撰寫範例 回傳新竹市市區公車路線資料（地理資料） # 介接新竹市市區公車路線資料 Hsinchu_bus_shape=Bus_Shape(app_id, app_key, &quot;Hsinchu&quot;, dtype=&quot;sf&quot;) ## [1] &quot;Success: (200) OK&quot; ## [1] &quot;#---Hsinchu Bus Route Downloaded---#&quot; # 查看THSR_station資料 Hsinchu_bus_shape # 地圖繪製 ggplot()+ geom_sf(data=Hsinchu_bus_station, aes(color=RouteName))+ geom_sf(data=Hsinchu_bus_shape, aes(color=RouteName)) NOTE R 語言中「地圖疊圖」之方法，請參考 Spatial Analysis with R (Chia Jung, Yeh) 3.7.1 小節 Map Overlay 3.3 公車班表資料  資料概述 在 TDX 平臺中，公車班表的記錄方式有兩種，一為「時刻表格式」，另一為發車「班距格式」。時刻表格式係指依據各路線的發車時間記錄班次，故有確切的時間點資料，而回傳結果之欄位含括（子）路線名稱、（子）路線代碼、方向、站點名稱、各星期是否營運、始發站代碼與站名、始發站發車時間。班距格式的回傳結果雷同，然未有確切的發車時間點，僅包含各時段發車的班距資料，如「07:00 至 09:00 每 5 分鐘一班公車」。時刻表格式為大部分公車資料的記錄方式，惟部分縣市因某些時段為彈性發車，故採班距與時刻表格式混合使用，尤以臺北市的公車班表資料紀錄方式較為複雜。在本函式中逕將時刻表與班距格式合併處理，使用者無需再撰寫額外程式碼進行分類。  函式參數 Bus_Schedule(app_id, app_key, county, out=FALSE) 參數 必選填 功能 參數設定值 app_id= 必填參數 [金鑰 APP ID] 1.6.2 API 金鑰申請的 APP ID app_key= [金鑰 APP Key] 1.6.2 API 金鑰申請的 APP Key county= 縣市代碼 請參照TDX_County表格，若為公路客運，請填入Intercity out= 選填參數 匯出資料之路徑 FALSE：不匯出資料至本機 [預設值] 若欲輸出此結果，路徑中必須含有.csv或.txt  程式碼撰寫範例 回傳新竹市市區公車班表資料 # 介接新竹市市區公車班表資料 Hsinchu_bus_schedule=Bus_Schedule(app_id, app_key, &quot;Hsinchu&quot;) ## [1] &quot;Success: (200) OK&quot; ## [1] &quot;#---Timetables Downloading---#&quot; ## [1] &quot;54 Routes&quot; ## [1] &quot;10/54&quot; ## [1] &quot;20/54&quot; ## [1] &quot;30/54&quot; ## [1] &quot;40/54&quot; ## [1] &quot;50/54&quot; ## [1] &quot;54/54&quot; ## [1] &quot;#---Hsinchu Bus Schedule Downloaded---#&quot; # 查看Hsinchu_bus_schedule資料 Hsinchu_bus_schedule "]]
